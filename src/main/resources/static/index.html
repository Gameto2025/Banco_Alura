<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Churn â€“ Banco Alura</title>

<style>
body {
    font-family: sans-serif;
    display: flex;
    justify-content: center;
    padding: 20px;
    background: #f4f7f6;
}

.card {
    background: white;
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 420px;
}

h2 { text-align: center; color: #2c3e50; }

.form-group { margin-bottom: 15px; }
label { display:block;margin-bottom:5px;color:#666; }

input,select {
    width:100%; padding:10px;border:1px solid #ddd;border-radius:5px;
}

.btn-consultar {
    width:100%;padding:14px;margin-top:15px;
    background:linear-gradient(135deg,#d97706,#b45309);
    color:white;border:none;border-radius:8px;
    font-size:16px;font-weight:700;cursor:pointer;transition:.25s;
}
.btn-consultar:hover{background:linear-gradient(135deg,#b45309,#92400e);}

.btn-dashboard{
    width:100%;padding:12px;margin-top:12px;
    background:linear-gradient(135deg,#1abc9c,#16a085);
    color:white;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;
}

#resultado{
    margin-top:20px;padding:15px;border-radius:8px;
    display:none;text-align:center;font-weight:600;
}
</style>
</head>

<body>
<div class="card">
<h2>Analizador de Clientes Banco Alura</h2>

<div class="form-group">
<label>Edad</label>
<input type="number" id="edad">
</div>

<div class="form-group">
<label>NÃºmero de productos</label>
<input type="number" id="productos">
</div>

<div class="form-group">
<label>Cuenta activa</label>
<select id="activo">
<option value="1">SÃ­</option>
<option value="0">No</option>
</select>
</div>

<div class="form-group">
<label>PaÃ­s</label>
<select id="pais">
<option value="0">Francia</option>
<option value="1">EspaÃ±a</option>
<option value="2">Alemania</option>
</select>
</div>

<button class="btn-consultar" onclick="realizarPrediccion()">ðŸ§  Consultar Churn</button>
<button class="btn-dashboard" onclick="window.location.href='/dashboard'">ðŸ“Š Ver Dashboard de Riesgos</button>

<div id="resultado">
    <div id="mensajeRespuesta"></div>
</div>
</div>

<script>
async function realizarPrediccion() {

const datos = {
    edad: parseInt(document.getElementById("edad").value),
    productos: parseInt(document.getElementById("productos").value),
    activo: parseInt(document.getElementById("activo").value),
    pais: parseInt(document.getElementById("pais").value)
};

const response = await fetch('/api/churn/predict', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify(datos)
});

const data = await response.json();

const porcentaje = (data.score * 100).toFixed(1) + "%";

document.getElementById("mensajeRespuesta").innerHTML = `
<b>Nivel de riesgo:</b> ${data.nivelRiesgo}<br>
<b>Probabilidad:</b> ${porcentaje}<br>
<b>Causas:</b> ${data.factoresClave}<br>
<b>RecomendaciÃ³n:</b> ${data.recomendacion}
`;

const r = document.getElementById("resultado");
r.style.border = "2px solid " + data.colorRiesgo;
r.style.color  = data.colorRiesgo;
r.style.display = "block";
}
</script>
</body>
</html>